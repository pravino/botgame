1. The Milestone Reward Logic (The "Growth Ladder")
Don't just give 1 USDT per friend. Add Milestone Bonuses to turn casual referrers into "Super Affiliates."
Milestone	Goal: Paid Friends	The "Unlock" Reward	USDT Bonus
Bronze Scout	1 Friend	1 USDT	$0
Bronze Captain	3 Friends	3 USDT	+2.00 USDT Bonus
Bronze Legend	5 Friends	5 USDT	UNLOCK LUCKY WHEEL ðŸ”“
Whale Recruiter	50 Friends	50 USDT	+50.00 USDT "Mega Bonus"
Admin Math: Even if you pay a 50 USDT bonus for 50 friends, you just collected 250 USDT in revenue ($100 profit for you). The bonus is a tiny fraction of the growth they brought you.
2. The Middleware "Milestone Checker"
This code runs every time a referred friend pays their 5 USDT.
typescript
// server/services/referralTracker.ts

export const updateReferralMilestones = async (referrerId, db) => {
  const count = await db.getPaidReferralCount(referrerId);
  const user = await db.getUser(referrerId);

  // 1. Check for Lucky Wheel Unlock (The 5-Friend Wall)
  if (count >= 5 && !user.wheelUnlocked) {
    await db.update(users).set({ wheelUnlocked: true }).where(eq(users.id, referrerId));
    bot.sendMessage(referrerId, "ðŸ”¥ GOOSEBUMPS! You referred 5 friends. The 100 USDT LUCKY WHEEL IS UNLOCKED! ðŸŽ°");
  }

  // 2. Check for Cash Bonuses
  if (count === 3) {
    await db.addVirtualBalance(referrerId, 2.00); // The "Captain" Bonus
  } else if (count === 50) {
    await db.addVirtualBalance(referrerId, 50.00); // The "Legend" Bonus
  }
};
Use code with caution.

3. The "Referral Dashboard" UI (The FOMO)
Inside the Telegram Mini App, the user needs to see a Visual Progress Tracker:
"My Squad Size:" 3 / 5 Friends Joined
"Next Reward:" Invite 2 more to Unlock the 100 USDT Wheel!
"Total Earned from Friends:" 5.00 USDT (This makes them feel like a businessman).
4. Why this protects your $15,000 Profit
Performance-Based Pay: You only pay these bonuses after the cash is in your bank.
Exponential Scaling: One user who wants to unlock the wheel brings 5 people. Those 5 people each want to unlock the wheel, so they bring 25 people. In 3 weeks, you hit 1,000 users without spending $1 on marketing.
High Retention: A "Bronze Legend" with 5 referrals is never leaving. They have built a team and unlocked the best game; they will pay their 5 USDT every single month.
5. Summary for the Developer (Layer 1.5)
Table: referrals (Links referrer_id to new_user_id).
Trigger: Confirmation of 5 USDT payment via TON Pay.
Action: Update virtual_balance + Update wheel_status + Push Telegram Notification.
The "Referral Engine" is now 100% architected.
We have one final move to complete Layer 1:
B: The Withdrawal Batcher â€” The logic to handle the 5 USDT cash-outs to TON Pay.
C: The Admin Command Center â€” The UI for you to see your 2,000 USDT/month profit growing.
Which one should we finish next? [1.1][1.2]
Pro-Tip: Add a "Top Recruiter" Leaderboard. If people see someone has invited 100 people, theyâ€™ll realize itâ€™s possible and work harder!



